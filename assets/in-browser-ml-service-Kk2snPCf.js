import{N as O}from"./main-DA1jwneq.js";var A=(e=>(e.ZERO_SHOT_CLASSIFICATION="Xenova/distilbert-base-uncased-mnli",e.FEATURE_EXTRACTION="Xenova/all-MiniLM-L6-v2",e.TEXT_CLASSIFICATION="Xenova/distilbert-base-uncased-finetuned-sst-2-english",e.QUESTION_ANSWERING="Xenova/distilbert-base-cased-distilled-squad",e.SUMMARIZATION="Xenova/distilbart-cnn-6-6",e.TRANSLATION_EN_FR="Xenova/opus-mt-en-fr",e.FILL_MASK="Xenova/distilbert-base-uncased",e.SENTENCE_SIMILARITY="Xenova/all-MiniLM-L6-v2",e.TOKEN_CLASSIFICATION="Xenova/distilbert-base-uncased-finetuned-conll03-english",e.IMAGE_CLASSIFICATION="Xenova/vit-base-patch16-224",e.OBJECT_DETECTION="Xenova/detr-resnet-50",e.OBJECT_DETECTION_YOLOV9="Xenova/yolos-tiny",e.OBJECT_DETECTION_YOLOV9_WEB="Xenova/yolov9-web",e.OBJECT_DETECTION_YOLOS_TINY="Xenova/yolos-tiny",e.OBJECT_DETECTION_YOLOS_SMALL="Xenova/yolos-small",e.OBJECT_DETECTION_YOLOS_BASE="Xenova/yolos-base",e.OBJECT_DETECTION_GELAN="Xenova/gelan-c_all",e.IMAGE_SEGMENTATION="Xenova/detr-resnet-50-panoptic",e.AUTOMATIC_SPEECH_RECOGNITION="Xenova/whisper-tiny",e.AUDIO_CLASSIFICATION="Xenova/wav2vec2-base",e))(A||{}),v=(e=>(e.ZERO_SHOT_CLASSIFICATION="zero-shot-classification",e.FEATURE_EXTRACTION="feature-extraction",e.TEXT_CLASSIFICATION="text-classification",e.SENTIMENT_ANALYSIS="sentiment-analysis",e.QUESTION_ANSWERING="question-answering",e.SUMMARIZATION="summarization",e.TRANSLATION="translation",e.FILL_MASK="fill-mask",e.SENTENCE_SIMILARITY="sentence-similarity",e.TOKEN_CLASSIFICATION="token-classification",e.IMAGE_CLASSIFICATION="image-classification",e.OBJECT_DETECTION="object-detection",e.AUTOMATIC_SPEECH_RECOGNITION="automatic-speech-recognition",e.AUDIO_CLASSIFICATION="audio-classification",e.IMAGE_TO_TEXT="image-to-text",e.TEXT_TO_IMAGE="text-to-image",e.IMAGE_SEGMENTATION="image-segmentation",e.DEPTH_ESTIMATION="depth-estimation",e))(v||{});function S(e){switch(e){case"zero-shot-classification":return"Xenova/distilbert-base-uncased-mnli";case"feature-extraction":return"Xenova/all-MiniLM-L6-v2";case"text-classification":case"sentiment-analysis":return"Xenova/distilbert-base-uncased-finetuned-sst-2-english";case"question-answering":return"Xenova/distilbert-base-cased-distilled-squad";case"summarization":return"Xenova/distilbart-cnn-6-6";case"translation":return"Xenova/opus-mt-en-fr";case"fill-mask":return"Xenova/distilbert-base-uncased";case"sentence-similarity":return"Xenova/all-MiniLM-L6-v2";case"token-classification":return"Xenova/distilbert-base-uncased-finetuned-conll03-english";case"image-classification":return"Xenova/vit-base-patch16-224";case"object-detection":return"Xenova/detr-resnet-50";case"image-segmentation":return"Xenova/detr-resnet-50-panoptic";case"automatic-speech-recognition":return"Xenova/whisper-tiny";case"audio-classification":return"Xenova/wav2vec2-base";default:return null}}function N(e){return new Worker("/assets/ml-worker-CIo_XCJJ.js",{type:"module",name:e?.name})}const E=O("InBrowserMLService");class c{constructor(){this.worker=null,this.pendingLoad=new Map,this.runRequestId=0,this.runPending=new Map}static getInstance(){return c.instance||(c.instance=new c),c.instance}getWorker(){return this.worker?this.worker:(this.worker=new N,this.worker.onmessage=t=>{const{type:i,requestId:s,result:r,error:n}=t.data??{};if(i==="runResult"){const a=s!=null?this.runPending.get(s):void 0;a&&(this.runPending.delete(s),n!=null?a.reject(new Error(n)):a.resolve(r))}},this.worker.onerror=t=>E.error(`ML worker error: ${t.message??String(t)}`),this.worker)}setAuthToken(t){try{this.getWorker().postMessage({type:"setAuthToken",token:t}),t?.trim()&&E.info("Hugging Face token set for authenticated model access")}catch(i){E.warn(`Failed to set auth token: ${i instanceof Error?i.message:String(i)}`)}}ensurePipelineLoaded(t,i,s,r){let n=this.pendingLoad.get(t);return n||(n=new Promise((a,u)=>{const l=I=>{const o=I.data??{};o.type!=="loadResult"||o.pipelineKey!==t||(this.getWorker().removeEventListener("message",l),this.pendingLoad.delete(t),o.error?u(new Error(o.error)):a())};this.getWorker().addEventListener("message",l),this.getWorker().postMessage({type:"load",pipelineKey:t,task:i,model:s,options:r})}),this.pendingLoad.set(t,n),n)}async getPipeline(t,i,s={}){const r=i||(typeof t!="string"?S(t):void 0);if(!r)throw new Error("Model is required");const n=t,a=r,u=`${n}:${a}`,l={quantized:!0,...s};return s.device==="webgpu"&&!("gpu"in navigator)&&(l.device=void 0),await this.ensurePipelineLoaded(u,n,a,l),(I,o)=>{const d=++this.runRequestId;return new Promise((T,g)=>{this.runPending.set(d,{resolve:T,reject:g}),this.getWorker().postMessage({type:"run",requestId:d,pipelineKey:u,input:I,options:o})})}}clearPipeline(t,i){const n=`${t}:${i}`;this.pendingLoad.delete(n),this.getWorker().postMessage({type:"clear",pipelineKey:n})}clearAllPipelines(){this.pendingLoad.clear(),this.worker&&this.worker.postMessage({type:"clearAll"})}}const _=c.getInstance();export{v as M,A as a,_ as i};
