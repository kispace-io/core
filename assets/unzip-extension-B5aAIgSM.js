import{r as g,T as w,y as n,w as v,u as l,v as b,a as y,t as z}from"./main-CqI8UPkK.js";import{J as x}from"./jszip.min-DvwSm7v9.js";g({command:{id:"unzip",name:"Unzip Archive",description:"Extract a zip archive from the workspace",parameters:[{name:"file",description:"the zip file to extract, if not provided, the current selection will be used",required:!1},{name:"target",description:"target folder to extract into, defaults to the zip filename without extension",required:!1}]},handler:{canExecute:e=>{let t=e.params&&e.params.file;if(!t){const a=n.get();if(!a||!("path"in a))return!1;t=a.path}return t.toLowerCase().endsWith(".zip")},execute:async e=>{let t=e.params&&e.params.file;t||(t=n.get().path);const a=await v.getWorkspace();if(!a){l("No workspace selected.");return}await b.runAsync("Extracting archive",async i=>{try{const s=await a.getResource(t);if(!s){l("File not found: "+t);return}let r=e.params&&e.params.target;r||(r=(t.split("/").pop()||"extracted").replace(/\.zip$/i,"")+"/"),i.message="Loading archive...",i.progress=0,await a.getResource(r,{create:!0});const u=await s.getContents({blob:!0}),p=await x.loadAsync(u),f=Object.values(p.files).filter(c=>!c.dir).length;let o=0;i.message=`Extracting to ${r.replace(/\/$/,"")}...`;for(const[c,d]of Object.entries(p.files)){if(d.dir)continue;const h=await d.async("blob"),m=`${r}${c}`;await(await a.getResource(m,{create:!0})).saveContents(h,{contentType:y.BINARY}),o++,i.progress=Math.round(o/f*100),i.message=`Extracting ${o}/${f} files...`}i.progress=100,z(`Archive extracted to ${r.replace(/\/$/,"")}: ${o} file(s)`)}catch(s){throw l("Failed to extract archive: "+s),s}})}},contribution:{target:w,icon:"box-archive",label:"Unzip",disabled:()=>{const e=n.get();return!e||!("path"in e)||!e.path.toLowerCase().endsWith(".zip")}}});
